<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SideFX Manual</title>
    <style>
        :root {
            --bg-primary: #1a1a1e;
            --bg-secondary: #252529;
            --bg-tertiary: #2d2d33;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent: #5588aa;
            --accent-hover: #77aacc;
            --border: #3a3a40;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Layout */
        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar .logo {
            width: 100%;
            max-width: 160px;
            margin-bottom: 0.5rem;
        }

        .hero {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .hero .logo {
            width: 280px;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .sidebar .version {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .sidebar nav ul {
            list-style: none;
        }

        .sidebar nav li {
            margin-bottom: 0.5rem;
        }

        .sidebar nav a {
            color: var(--text-secondary);
            text-decoration: none;
            display: block;
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .sidebar nav a:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .sidebar nav a.active {
            color: var(--accent);
            background: var(--bg-tertiary);
        }

        /* Main content */
        .main {
            margin-left: 260px;
            padding: 40px 60px;
            max-width: 900px;
        }

        .main h2 {
            font-size: 1.8rem;
            margin-top: 3rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border);
            color: var(--text-primary);
        }

        .main h2:first-child {
            margin-top: 0;
        }

        .main h3 {
            font-size: 1.3rem;
            margin-top: 2rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .main p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .main ul, .main ol {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }

        .main li {
            margin-bottom: 0.5rem;
        }

        .main code {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 0.9em;
        }

        .main pre {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .main pre code {
            background: none;
            padding: 0;
        }

        /* Keyboard shortcuts */
        kbd {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 0.1rem 0.4rem;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 0.85em;
        }

        /* Tips/Notes */
        .tip {
            background: rgba(85, 136, 170, 0.1);
            border-left: 3px solid var(--accent);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }

        .tip strong {
            color: var(--accent);
        }

        /* Warning boxes */
        .warning {
            background: rgba(200, 100, 50, 0.15);
            border-left: 3px solid #c86432;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 6px 6px 0;
        }

        .warning strong {
            color: #c86432;
        }

        /* Inline icons */
        .icon {
            width: 18px;
            height: 18px;
            vertical-align: middle;
            margin: 0 2px;
            display: inline-block;
        }

        /* Screenshots */
        .screenshot {
            margin: 1.5rem 0;
            text-align: center;
        }

        .screenshot img {
            max-width: 100%;
            border-radius: 8px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .screenshot figcaption {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        th {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        td {
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .main {
                margin-left: 0;
                padding: 20px;
            }

            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <img src="assets/logo.svg" alt="SideFX" class="logo">
            <p class="version" id="version">v0.2.0</p>
            <nav>
                <ul>
                    <li><a href="#installation">Installation</a></li>
                    <li><a href="#how-it-works">How It Works</a></li>
                    <li><a href="#quick-start">Quick Start</a></li>
                    <li><a href="#browser">Plugin Browser</a></li>
                    <li><a href="#devices">Devices</a></li>
                    <li><a href="#post-fx">Post FX</a></li>
                    <li><a href="#racks">Racks &amp; Chains</a></li>
                    <li><a href="#modulators">Modulators</a></li>
                    <li><a href="#baking">Baking Automation</a></li>
                    <li><a href="#presets">Presets</a></li>
                    <li><a href="#settings">Settings</a></li>
                    <li><a href="#shortcuts">Keyboard Shortcuts</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                </ul>
            </nav>
        </aside>

        <main class="main">
            <div class="hero">
                <img src="assets/logo.svg" alt="SideFX" class="logo">
                <p>Parallel routing and modulation for REAPER 7+ — Ableton/Bitwig style</p>
            </div>

            <h2 id="installation">Installation</h2>
            <p>SideFX requires REAPER 7.0 or later.</p>

            <h3>Via ReaBoot (Easiest)</h3>
            <p><a href="https://reaboot.com/">ReaBoot</a> automatically installs SideFX and all its dependencies in one click.</p>
            <ol>
                <li>Go to <a href="https://reaboot.com/">reaboot.com</a></li>
                <li>Search for "SideFX"</li>
                <li>Click Install - ReaBoot handles everything</li>
            </ol>

            <h3>Via ReaPack (Manual)</h3>
            <p>If you already have ReaPack installed, you'll need to install SideFX and its dependencies separately.</p>

            <h4>Step 1: Install Dependencies</h4>
            <p>Go to <strong>Extensions &gt; ReaPack &gt; Browse packages</strong> and install each of these:</p>
            <table>
                <tr>
                    <th>Package</th>
                    <th>Repository</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>ReaImGui</strong></td>
                    <td>ReaTeam Extensions</td>
                    <td>ImGui bindings for REAPER UI</td>
                </tr>
                <tr>
                    <td><strong>ReaWrap</strong></td>
                    <td>Conceptual Machines</td>
                    <td>OOP wrapper library</td>
                </tr>
                <tr>
                    <td><strong>RPP-Parser</strong></td>
                    <td>ReaTeam Scripts</td>
                    <td>Required for preset save/load</td>
                </tr>
                <tr>
                    <td><strong>js_ReaScriptAPI</strong> (optional)</td>
                    <td>ReaTeam Extensions</td>
                    <td>Custom preset folder selection</td>
                </tr>
            </table>

            <h4>Step 2: Add Conceptual Machines Repositories</h4>
            <ol>
                <li>Go to <strong>Extensions &gt; ReaPack &gt; Import repositories...</strong></li>
                <li>Paste both URLs (one per line):
                    <pre><code>https://github.com/Conceptual-Machines/ReaWrap/raw/main/index.xml
https://github.com/Conceptual-Machines/SideFX/raw/main/index.xml</code></pre>
                </li>
                <li>Click OK</li>
            </ol>

            <h4>Step 3: Install SideFX</h4>
            <ol>
                <li>Go to <strong>Extensions &gt; ReaPack &gt; Browse packages</strong></li>
                <li>Search for "SideFX"</li>
                <li>Right-click and select <strong>Install</strong></li>
                <li>Restart REAPER</li>
            </ol>

            <h3>Running SideFX</h3>
            <p>After installation:</p>
            <ol>
                <li>Go to <strong>Actions &gt; Show action list</strong></li>
                <li>Search for "SideFX"</li>
                <li>Select the action and click <strong>Run</strong></li>
                <li>(Optional) Assign a keyboard shortcut for quick access</li>
            </ol>

            <!-- ============================================================ -->

            <h2 id="how-it-works">How It Works</h2>
            <p>SideFX provides an Ableton/Bitwig-style interface for managing REAPER's FX chain. Understanding how it works under the hood will help you get the most out of it.</p>

            <h3>Container-Based Architecture</h3>
            <p>SideFX uses REAPER 7's <strong>Container FX</strong> as its primary building block. Every device, rack, and chain you create is actually a container with a specific naming convention:</p>
            <ul>
                <li><strong>Devices</strong> (<code>D1:</code>, <code>D2:</code>, etc.) - Containers wrapping individual plugins with utility controls</li>
                <li><strong>Bare Devices</strong> (<code>BD1:</code>, <code>BD2:</code>, etc.) - Lightweight plugins without container wrapper</li>
                <li><strong>Racks</strong> (<code>R1</code>, <code>R2</code>, etc.) - Containers for parallel processing</li>
                <li><strong>Chains</strong> (<code>C1</code>, <code>C2</code>, etc.) - Containers for each parallel path within a rack</li>
                <li><strong>Post FX</strong> (<code>POST1:</code>, <code>POST2:</code>, etc.) - Analyzers and metering at end of chain</li>
            </ul>
            <p>This approach gives SideFX full control over the FX structure while leveraging REAPER's native container capabilities.</p>

            <h3>Device Structure (D-containers)</h3>
            <p>When you add a plugin through SideFX, it gets wrapped in a <strong>D-container</strong> with the following structure:</p>
            <pre><code>D1: Plugin Name (Container)
├── D1_FX: Plugin Name (your plugin)
└── D1_Util (SideFX_Utility JSFX)</code></pre>
            <p>The utility JSFX provides additional controls like pre/post gain and routing options that appear in the device sidebar.</p>

            <h3>Bare Devices (BD-containers)</h3>
            <p><strong>Bare devices</strong> are a lightweight alternative to full D-containers. They display the plugin directly without wrapping it in a container:</p>
            <pre><code>BD1: Plugin Name (the plugin itself, no container)</code></pre>
            <p>Bare devices have these characteristics:</p>
            <ul>
                <li><strong>No utility controls</strong> - No pre/post gain, mix, or delta controls</li>
                <li><strong>No modulator support</strong> - Cannot add LFO modulators</li>
                <li><strong>Simpler UI</strong> - Compact panel showing only the plugin's parameters</li>
                <li><strong>Lower overhead</strong> - No container wrapper or utility JSFX</li>
            </ul>
            <p>Bare devices are useful for simple plugins that don't need the extra controls, or when you want to minimize CPU overhead. Post FX (oscilloscope, spectrum analyzer) are always bare devices.</p>

            <h3>Rack Structure (R-containers)</h3>
            <p>Racks enable parallel processing by splitting audio into multiple chains:</p>
            <pre><code>R1 (Container)
├── SideFX_Mixer (JSFX - mixes all chains)
├── C1 (Chain container)
│   └── D1: Effect A
├── C2 (Chain container)
│   └── D2: Effect B
└── C3 (Chain container)
    └── D3: Effect C</code></pre>
            <p>Audio enters the rack, gets duplicated to each chain, processed independently, then mixed back together by the SideFX_Mixer.</p>

            <h3>JSFX Plugins</h3>
            <p>SideFX includes three custom JSFX plugins that power its features:</p>
            <table>
                <tr>
                    <th>Plugin</th>
                    <th>Purpose</th>
                </tr>
                <tr>
                    <td><strong>SideFX_Utility</strong></td>
                    <td>Added to every device. Provides pre-gain, post-gain, and the Mix (dry/wet) and Delta controls shown in the device sidebar.</td>
                </tr>
                <tr>
                    <td><strong>SideFX_Mixer</strong></td>
                    <td>Added to every rack. A 16-channel mixer that combines parallel chains with individual volume, pan, mute, and solo controls per chain.</td>
                </tr>
                <tr>
                    <td><strong>SideFX_Modulator</strong></td>
                    <td>The LFO engine. Contains the actual modulation logic including rate, curve interpolation, tempo sync, and parameter output. See the Modulators section for details.</td>
                </tr>
            </table>

            <div class="tip">
                <strong>Note:</strong> These JSFX plugins are hidden from the plugin browser and are implementation details. They are automatically added and managed by SideFX — you should not add or configure them manually.
            </div>

            <h3>SideFX as Your FX Manager</h3>
            <p>SideFX is designed to be the <strong>primary interface</strong> for managing your track's effects. When you use SideFX, it takes ownership of the FX chain structure.</p>

            <div class="warning">
                <strong>Important:</strong> Avoid modifying SideFX-created containers directly in REAPER's FX window. Renaming, reordering, or restructuring containers outside of SideFX may cause unexpected behavior or break the interface. Always use SideFX to manage devices, racks, and chains.
            </div>

            <h3>What You Can Safely Do in REAPER</h3>
            <ul>
                <li>Adjust plugin parameters (they sync with SideFX)</li>
                <li>Open plugin UIs from REAPER's FX window</li>
                <li>Add automation to parameters</li>
                <li>Copy/paste entire tracks</li>
            </ul>

            <h3>What to Avoid</h3>
            <ul>
                <li>Renaming containers created by SideFX</li>
                <li>Moving FX in/out of SideFX containers manually</li>
                <li>Deleting individual items from within containers</li>
                <li>Adding FX directly inside SideFX containers</li>
            </ul>

            <!-- ============================================================ -->

            <h2 id="quick-start">Quick Start</h2>
            <p>Get up and running with SideFX in minutes.</p>

            <figure class="screenshot">
                <img src="images/overview.png" alt="SideFX main interface">
                <figcaption>The SideFX interface showing the plugin browser, device chain, and rack</figcaption>
            </figure>

            <h3>1. Open SideFX</h3>
            <p>Run the SideFX action from REAPER's action list, or assign it to a keyboard shortcut.</p>

            <h3>2. Select a Track</h3>
            <p>SideFX operates on the currently selected track. Select a track in REAPER's arrange view or mixer.</p>

            <h3>3. Add Plugins</h3>
            <p>Use the plugin browser on the left to find and add plugins. Double-click a plugin or drag it onto the device chain.</p>

            <h3>4. Create a Rack</h3>
            <p>Click <strong>+ Rack</strong> to create a parallel processing rack. Add devices to each chain for parallel effects.</p>

            <figure class="screenshot">
                <img src="images/rack.png" alt="A rack with multiple chains">
                <figcaption>A rack containing two parallel chains with different effects</figcaption>
            </figure>

            <h3>5. Add Modulation</h3>
            <p>Expand a device panel and use the modulator section to add LFO modulation to any parameter.</p>

            <figure class="screenshot">
                <img src="images/modulator.png" alt="Modulator panel">
                <figcaption>A modulator linked to a filter cutoff parameter</figcaption>
            </figure>

            <!-- ============================================================ -->

            <h2 id="browser">Plugin Browser</h2>
            <p>The plugin browser on the left side of SideFX lets you find and add plugins to your device chain.</p>

            <img src="images/browser.png" alt="Plugin browser panel" class="screenshot" style="max-width: 300px;">

            <h3>Searching Plugins</h3>
            <ul>
                <li><strong>Search box</strong> - Type to filter plugins by name or manufacturer</li>
                <li><strong>Type filter</strong> - Filter by plugin type (Instruments, Effects, JSFX, etc.)</li>
                <li>Results update as you type</li>
            </ul>

            <h3>Adding Plugins</h3>
            <ul>
                <li><strong>Double-click</strong> a plugin to add it at the end of the chain</li>
                <li><strong>Drag and drop</strong> to add at a specific position</li>
                <li><strong>Add as Bare</strong> - Hold <kbd>Shift</kbd> while adding to create a bare device (no utility controls or modulator support)</li>
                <li><strong>Add as Post FX</strong> - Drop onto the Post FX area (right edge) to add as a post-chain analyzer/meter</li>
            </ul>

            <h3>Selecting Parameters</h3>
            <p>Right-click a device header and select <strong>Select Parameters</strong> to choose which parameters appear in the device panel. The parameter selector dialog lets you:</p>
            <ul>
                <li>Check/uncheck parameters to show or hide them</li>
                <li>Set unit overrides (dB, Hz, ms, %, etc.) for each parameter</li>
                <li>Search parameters by name</li>
            </ul>

            <figure class="screenshot">
                <img src="images/param-selector.png" alt="Parameter selector dialog">
                <figcaption>The parameter selector with unit override dropdowns</figcaption>
            </figure>

            <!-- ============================================================ -->

            <h2 id="devices">Devices</h2>
            <p>Devices are the building blocks of your FX chain. Each device wraps a plugin in a container with additional controls.</p>

            <h3>Device Controls</h3>
            <p>Each device panel shows:</p>
            <ul>
                <li><strong>Header</strong> - Device name (click to rename), enable/disable toggle</li>
                <li><strong>Parameters</strong> - Configurable parameter sliders</li>
                <li><strong>Sidebar</strong> - Mix (dry/wet), Delta (difference mode)</li>
            </ul>

            <h3>Device Context Menu</h3>
            <p>Right-click a device header for options:</p>
            <ul>
                <li><strong>Rename</strong> - Change the device display name</li>
                <li><strong>Select Parameters</strong> - Configure visible parameters</li>
                <li><strong>Open Plugin UI</strong> - Show the plugin's native interface</li>
                <li><strong>Delete</strong> - Remove the device</li>
            </ul>

            <!-- ============================================================ -->

            <h2 id="post-fx">Post FX</h2>
            <p>The Post FX area sits at the end of your device chain, after all your main effects and racks. It's designed for analysis tools and final-stage processing that should always come last in the signal flow.</p>

            <img src="images/post-fx.png" alt="Post FX area with analyzers" class="screenshot" style="max-width: 300px;">

            <h3>What is Post FX?</h3>
            <p>Post FX is a dedicated section that appears to the right of your main device chain. Unlike regular devices:</p>
            <ul>
                <li><strong>Always at the end</strong> - Post FX devices stay after your main chain, regardless of how you reorder other devices</li>
                <li><strong>Bare devices</strong> - Post FX plugins are added without the D-container wrapper (no utility controls or modulator support)</li>
                <li><strong>Named with POST prefix</strong> - Post FX devices use <code>POST1:</code>, <code>POST2:</code> naming to distinguish them from main chain devices</li>
            </ul>

            <h3>Adding Post FX</h3>
            <p>Drag a plugin from the browser and drop it on the Post FX area (the bordered region at the right edge of the chain). The plugin will be added as a bare device with the POST prefix.</p>

            <div class="tip">
                <strong>Tip:</strong> Post FX is ideal for metering plugins, analyzers, loudness meters, or any tool you want to monitor your final output without affecting the main processing chain.
            </div>

            <h3 id="analyzers">Analyzers</h3>
            <p>SideFX includes built-in audio analysis tools that live in the Post FX area.</p>

            <img src="images/analyzers.png" alt="Oscilloscope and Spectrum analyzer panels" class="screenshot" style="max-width: 500px;">

            <h4>Available Analyzers</h4>
            <table>
                <tr>
                    <th>Analyzer</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>Oscilloscope</strong></td>
                    <td>Stereo waveform display with logarithmic dB scale. Shows left channel (green) and right channel (magenta).</td>
                </tr>
                <tr>
                    <td><strong>Spectrum</strong></td>
                    <td>Frequency response analyzer with logarithmic frequency scale (20Hz-20kHz).</td>
                </tr>
            </table>

            <h4>Adding Analyzers</h4>
            <p>Click the <img src="images/icons/oscilloscope.png" alt="Scope" class="icon"> <strong>Scope</strong> or <img src="images/icons/spectrum.png" alt="Spectrum" class="icon"> <strong>Spectrum</strong> button in the toolbar to add an analyzer. Analyzers appear in the Post FX area at the end of your device chain.</p>

            <h4>Analyzer Controls</h4>
            <p>Each analyzer panel provides these controls in the header:</p>
            <ul>
                <li><strong>Collapse/Expand</strong> (▼/▶) - Toggle between full view and compact strip</li>
                <li><strong>Freeze</strong> <img src="images/icons/pause.png" alt="Pause" class="icon"> - Pause the display to inspect a moment in time</li>
                <li><strong>Popout</strong> <img src="images/icons/pop-out.png" alt="Popout" class="icon"> - Open the analyzer in a separate resizable window</li>
                <li><strong>Power</strong> <img src="images/icons/on.png" alt="Power" class="icon"> - Enable or bypass the analyzer</li>
                <li><strong>Delete</strong> (X) - Remove the analyzer from the chain</li>
            </ul>

            <h4>Collapsed View</h4>
            <p>When collapsed, analyzers display as a narrow vertical strip showing only the essential controls: expand button, popout, power, and delete. This saves screen space while keeping analyzers accessible.</p>

            <h4>Popout Windows</h4>
            <p>Click the <img src="images/icons/pop-out.png" alt="Popout" class="icon"> popout button to open an analyzer in its own resizable window. This is useful for larger displays or when you want to keep the analyzer visible while working on other parts of your chain. The inline panel hides when popped out.</p>

            <h4>Bypass Behavior</h4>
            <p>When an analyzer is bypassed (power off), the visualization area shows only the grid and labels — the actual waveform or spectrum data is cleared. This provides a clear visual indication that the analyzer is inactive while maintaining the panel structure.</p>

            <!-- ============================================================ -->

            <h2 id="racks">Racks &amp; Chains</h2>
            <p>Racks enable parallel processing with multiple chains that can be mixed together.</p>

            <h3>Creating a Rack</h3>
            <ol>
                <li>Click the <img src="images/icons/rack.png" alt="Rack" class="icon"> <strong>Rack</strong> button in the toolbar (or drag it to a specific position)</li>
                <li>A new rack appears with one empty chain</li>
                <li>Drag plugins from the browser into the chain</li>
            </ol>

            <h3>Adding Chains</h3>
            <p>Click the <strong>+</strong> button at the bottom of a rack to add a new chain. Each chain processes audio in parallel.</p>

            <div class="tip">
                <strong>Note:</strong> Each rack supports up to 16 parallel chains.
            </div>

            <h3>Chain Mixer</h3>
            <p>Each rack has a built-in mixer with per-chain controls:</p>
            <ul>
                <li><strong>Volume</strong> - Chain output level</li>
                <li><strong>Pan</strong> - Stereo position</li>
                <li><strong>Mute/Solo</strong> - Isolate chains for mixing</li>
            </ul>

            <h3>Converting Chains to Devices</h3>
            <p>Right-click a chain header and select <strong>Convert to Devices</strong> to extract the chain's contents back to the main device chain.</p>

            <!-- ============================================================ -->

            <h2 id="modulators">Modulators</h2>
            <p>Modulators add movement to your sound by automatically varying parameter values over time.</p>

            <h3>How Modulators Work</h3>
            <p>Each modulator is powered by the <strong>SideFX_Modulator</strong> JSFX plugin. The JSFX handles all the real-time modulation logic:</p>
            <ul>
                <li><strong>LFO generation</strong> - Produces the oscillating signal based on rate and curve shape</li>
                <li><strong>Tempo sync</strong> - Locks to REAPER's tempo when sync is enabled</li>
                <li><strong>Curve interpolation</strong> - Reads the bezier curve data and generates smooth output</li>
                <li><strong>Parameter output</strong> - Outputs a 0-1 signal that REAPER's parameter linking system uses</li>
            </ul>
            <p>SideFX's UI controls the JSFX parameters and uses REAPER's native <strong>parameter linking</strong> (plink) system to connect the modulator output to your target parameters. This means modulation happens at the audio engine level, not in the script.</p>

            <h3>Adding a Modulator</h3>
            <ol>
                <li>Expand a device panel</li>
                <li>In the modulator section, click <strong>+ Mod</strong></li>
                <li>A new LFO modulator appears</li>
            </ol>

            <h3>Linking Parameters</h3>
            <p>To link a parameter to a modulator:</p>
            <ol>
                <li>Add a modulator to the device</li>
                <li><strong>Right-click</strong> any parameter slider in the device</li>
                <li>Select <strong>Link to LFO 1</strong> (or LFO 2, etc.)</li>
                <li>The parameter will now be modulated by the LFO</li>
            </ol>

            <p>Modifier keys when linking:</p>
            <ul>
                <li><kbd>Ctrl</kbd> + right-click: Link in <strong>bipolar</strong> mode (modulates above and below the current value)</li>
                <li><kbd>Alt</kbd> + right-click: Link with <strong>negative</strong> depth (inverted modulation)</li>
                <li><kbd>Ctrl</kbd> + <kbd>Alt</kbd> + right-click: Both bipolar and negative</li>
            </ul>

            <img src="images/mod-amount.png" alt="Parameter link context menu" class="screenshot" style="max-width: 350px;">

            <h3>Modulator Controls</h3>
            <table>
                <tr>
                    <th>Control</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>Rate</strong></td>
                    <td>LFO speed in Hz (when in Free mode)</td>
                </tr>
                <tr>
                    <td><strong>Free/Sync</strong></td>
                    <td>Toggle between free-running Hz rate or tempo-synced divisions</td>
                </tr>
                <tr>
                    <td><strong>Sync Rate</strong></td>
                    <td>Tempo-synced rate (1/4, 1/8, 1/16, etc.) when Sync is enabled</td>
                </tr>
                <tr>
                    <td><strong>Trigger</strong></td>
                    <td>LFO restart mode: Free (continuous), Transport (restart on play), MIDI (restart on note), Audio (restart on transient). Click to expand advanced settings for MIDI/Audio trigger configuration.</td>
                </tr>
                <tr>
                    <td><strong>Loop/One-shot</strong></td>
                    <td>Toggle between looping LFO or single envelope playback</td>
                </tr>
                <tr>
                    <td><strong>Phase</strong></td>
                    <td>LFO starting position (0-360°)</td>
                </tr>
                <tr>
                    <td><strong>Curve</strong></td>
                    <td>LFO shape display (click to open curve editor)</td>
                </tr>
            </table>

            <h3>Curve Editor</h3>
            <p>Click the curve display to open the curve editor. Create custom LFO shapes by adding and moving control points. Use bezier handles for smooth curves.</p>

            <figure class="screenshot">
                <img src="images/curve-editor.png" alt="Curve editor" style="max-width: 400px;">
                <figcaption>The curve editor with a custom LFO shape</figcaption>
            </figure>

            <div class="tip">
                <strong>Tip:</strong> Hold <kbd>Shift</kbd> while dragging sliders for fine control.
            </div>

            <h3>Mod Matrix</h3>
            <p>The Mod Matrix provides a unified view of all parameter links within a device, making it easy to manage multiple modulation assignments at once.</p>

            <img src="images/mod-matrix.png" alt="Mod Matrix dialog showing parameter links" class="screenshot" style="max-width: 450px;">

            <h4>Opening the Mod Matrix</h4>
            <p>Click the <img src="images/icons/matrix.png" alt="Matrix" class="icon"> matrix button in the modulator header to open the Mod Matrix dialog for that device. The dialog shows all parameter links from all modulators in the device.</p>

            <h4>Matrix Columns</h4>
            <table>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>LFO</strong></td>
                    <td>Which modulator (LFO 1, 2, etc.) controls this link</td>
                </tr>
                <tr>
                    <td><strong>Device</strong></td>
                    <td>The target device name</td>
                </tr>
                <tr>
                    <td><strong>Param</strong></td>
                    <td>The linked parameter name</td>
                </tr>
                <tr>
                    <td><strong>Mode</strong></td>
                    <td><strong>U</strong> (Unipolar: 0 to +depth) or <strong>B</strong> (Bipolar: -depth to +depth)</td>
                </tr>
                <tr>
                    <td><strong>Depth</strong></td>
                    <td>Modulation amount slider (-1 to +1)</td>
                </tr>
                <tr>
                    <td><strong>Dis</strong></td>
                    <td>Disable/enable the link without removing it</td>
                </tr>
                <tr>
                    <td><strong>Bake</strong></td>
                    <td>Bake this link to automation</td>
                </tr>
                <tr>
                    <td><strong>Del</strong></td>
                    <td>Remove the parameter link</td>
                </tr>
            </table>

            <h4>Disabling vs Removing Links</h4>
            <p>Use the <strong>Dis</strong> button to temporarily disable a link while preserving its depth setting. This is useful for A/B comparisons. The <strong>Del</strong> button permanently removes the link.</p>

            <!-- ============================================================ -->

            <h2 id="baking">Baking Automation</h2>
            <p>Convert modulator movements into REAPER automation envelopes for precise editing or to free up CPU.</p>

            <h3>How to Bake</h3>
            <ol>
                <li>Set up your modulator and parameter link</li>
                <li>Click the <strong>Bake</strong> button on the modulator</li>
                <li>Choose a range (project, track, time selection, or selected items)</li>
                <li>Click <strong>Bake</strong> to create the automation</li>
            </ol>

            <h3>Range Modes</h3>
            <table>
                <tr>
                    <th>Mode</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>Project</strong></td>
                    <td>Entire project length</td>
                </tr>
                <tr>
                    <td><strong>Track</strong></td>
                    <td>From first to last item on track</td>
                </tr>
                <tr>
                    <td><strong>Time Selection</strong></td>
                    <td>Current time selection</td>
                </tr>
                <tr>
                    <td><strong>Selected Items</strong></td>
                    <td>Duration of selected items</td>
                </tr>
            </table>

            <h3>Bake Settings</h3>
            <p>Configure baking behavior in <strong>Settings</strong>:</p>
            <ul>
                <li><strong>Disable link after bake</strong> - Automatically unlink the parameter after baking</li>
                <li><strong>Default range mode</strong> - Pre-select your preferred range</li>
                <li><strong>Show range picker</strong> - Skip the dialog and use defaults</li>
            </ul>

            <!-- ============================================================ -->

            <h2 id="presets">Presets</h2>
            <p>Save and load your entire FX chain configuration, including all devices, racks, modulators, and parameter links.</p>

            <h3>Saving a Preset</h3>
            <ol>
                <li>Click the <img src="images/icons/save.png" alt="Save" class="icon"> save button in the toolbar</li>
                <li>Enter a name for your preset</li>
                <li>Click <strong>Save</strong></li>
            </ol>
            <p>Presets are saved to a <code>SideFX/chains/</code> folder in your REAPER resources directory. Each preset consists of:</p>
            <ul>
                <li>An <code>.RfxChain</code> file (REAPER-compatible FX chain)</li>
                <li>A <code>.sidefx.json</code> file (SideFX metadata: display names, parameter selections, modulator links)</li>
            </ul>

            <h3>Loading a Preset</h3>
            <ol>
                <li>Click the <img src="images/icons/save.png" alt="Save" class="icon"> save button in the toolbar</li>
                <li>Select a preset from the list</li>
                <li>Click <strong>Load</strong></li>
            </ol>

            <div class="warning">
                <strong>Warning:</strong> Loading a preset replaces all FX on the current track. Make sure to save your current setup first if needed.
            </div>

            <h3>What Gets Saved</h3>
            <ul>
                <li>All devices, racks, and chains</li>
                <li>Plugin settings and parameter values</li>
                <li>Custom device display names</li>
                <li>Parameter visibility selections</li>
                <li>Modulator configurations and parameter links</li>
            </ul>

            <!-- ============================================================ -->

            <h2 id="settings">Settings</h2>
            <p>Click the <img src="images/icons/gear.png" alt="Settings" class="icon"> gear button in the toolbar to access settings.</p>

            <h3>Display</h3>
            <ul>
                <li><strong>Show track name</strong> - Display current track in toolbar</li>
                <li><strong>Show breadcrumbs</strong> - Navigation path when inside containers</li>
                <li><strong>Show Mix/Delta controls</strong> - Sidebar wet/dry and delta controls</li>
                <li><strong>Show phase controls</strong> - Phase slider in modulator panel</li>
            </ul>

            <h3>Parameters</h3>
            <ul>
                <li><strong>Max visible parameters</strong> - Limit parameters shown per device (default: 32)</li>
            </ul>

            <h3>Bake</h3>
            <ul>
                <li><strong>Disable link after bake</strong> - Auto-disable parameter link after baking</li>
                <li><strong>Default range mode</strong> - Default range for bake dialog</li>
                <li><strong>Show range picker modal</strong> - Show range selection dialog</li>
            </ul>

            <!-- ============================================================ -->

            <h2 id="shortcuts">Keyboard Shortcuts</h2>
            <table>
                <tr>
                    <th>Shortcut</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td><kbd>Shift</kbd> + drag</td>
                    <td>Fine control on sliders</td>
                </tr>
                <tr>
                    <td>Double-click slider</td>
                    <td>Reset to default value</td>
                </tr>
                <tr>
                    <td>Double-click plugin</td>
                    <td>Add plugin to chain</td>
                </tr>
                <tr>
                    <td>Right-click device</td>
                    <td>Open context menu</td>
                </tr>
            </table>

            <!-- ============================================================ -->

            <h2 id="troubleshooting">Troubleshooting</h2>

            <h3>Cannot dock window in fresh REAPER install</h3>
            <p>On a fresh REAPER installation with no docked windows, SideFX may not dock into REAPER's docker. This is a REAPER/ReaImGui limitation where the docker needs to be "activated" first.</p>

            <p><strong>Workaround:</strong> Dock any native REAPER window (e.g., Actions, Mixer) first, then SideFX will be able to dock.</p>

            <h3>Multiple Serum instances don't receive MIDI</h3>
            <p>When using multiple Serum (or Serum 2) instances on the same track, only the first instance receives MIDI by default. This is because REAPER's VST instruments default to "Replace MIDI bus" mode instead of "Merge with MIDI bus".</p>

            <p><strong>Workaround:</strong> For each additional Serum instance:</p>
            <ol>
                <li>Open the FX window for the Serum plugin (double-click the device header)</li>
                <li>Click the <strong>I/O</strong> button (routing)</li>
                <li>Under <strong>MIDI Output</strong>, select <strong>"Merges with MIDI bus"</strong></li>
            </ol>

            <div class="tip">
                <strong>Note:</strong> This setting is not exposed via REAPER's scripting API, so SideFX cannot set it automatically. This affects any instrument plugin that needs to pass MIDI to subsequent plugins.
            </div>

        </main>
    </div>
    <script>
        // Load version from version.json
        fetch('version.json')
            .then(response => response.json())
            .then(data => {
                document.getElementById('version').textContent = 'v' + data.version;
            })
            .catch(() => {
                // Keep fallback version if fetch fails
            });
    </script>
</body>
</html>
